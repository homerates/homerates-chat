<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HomeRates.ai — Ask Me Anything</title>
  <style>
    :root{
      --bg:#0b1a2a;       /* dark navy */
      --bg-2:#10243a;
      --panel:#0f2136;
      --text:#e8eef6;
      --muted:#9db3c6;
      --accent:#2eaadc;
      --border:#1d3653;
      --chip:#14304b;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text); background:var(--bg);
      font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}

    .app{
      display:grid;
      grid-template-columns:280px 1fr;
      height:100vh; width:100vw;
    }
    /* Sidebar */
    .sidebar{
      background:var(--panel);
      border-right:1px solid var(--border);
      padding:14px 12px; overflow:auto;
    }
    .sb-head{display:flex; align-items:center; gap:10px; margin-bottom:12px}
    .logo{width:28px;height:28px;border-radius:6px;background:var(--chip)}
    .brand{font-weight:600}
    .sb-actions{display:flex; gap:8px; margin-bottom:10px}
    .btn{
      background:var(--chip); color:var(--text); border:1px solid var(--border);
      padding:8px 10px; border-radius:10px; cursor:pointer;
    }
    .btn:hover{background:var(--bg-2)}
    .sb-section{margin-top:10px}
    .sb-title{font-size:13px; color:var(--muted); margin:10px 6px}
    .sb-list{list-style:none; padding:0; margin:0}
    .sb-list li{padding:8px 10px; border-radius:8px; cursor:pointer}
    .sb-list li:hover{background:var(--bg-2)}

    /* Main */
    .main{display:flex; flex-direction:column; height:100vh; overflow:hidden}
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:8px; padding:10px 14px; border-bottom:1px solid var(--border); background:var(--panel);
    }
    .title{font-weight:600}
    .loading{font-size:12px; color:var(--muted)}
    .toggle{display:none} /* mobile shows this */

    .thread{flex:1; overflow:auto; padding:18px; scroll-behavior:smooth}
    .msg{background:var(--bg-2); border:1px solid var(--border); padding:12px 14px; border-radius:12px; margin:10px 0}
    .msg.user{background:#0e2033}
    .sources-head{margin-top:8px; font-size:13px; color:var(--muted)}
    .sources{margin:6px 0 0 0; padding-left:18px}
    .sources li{margin:4px 0}

    .composer{
      border-top:1px solid var(--border); background:var(--panel);
      padding:12px; display:flex; gap:10px;
    }
    .query{
      width:100%; resize:vertical; min-height:48px; max-height:220px;
      padding:12px; color:var(--text); background:var(--bg);
      border:1px solid var(--border); border-radius:12px;
      outline:none;
    }
    .send{min-width:92px}

    /* Mobile */
    @media (max-width: 860px){
      .app{grid-template-columns:1fr}
      .sidebar{position:fixed; inset:0 auto 0 0; width:80vw; max-width:320px; transform:translateX(-100%); transition:transform .2s ease}
      body.sidebar-open .sidebar{transform:translateX(0)}
      .overlay{display:none}
      body.sidebar-open .overlay{display:block; position:fixed; inset:0; background:rgba(0,0,0,.35)}
      .toggle{display:inline-flex}
    }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar" id="sidebar">
      <div class="sb-head">
        <div class="logo" id="logo"></div>
        <div class="brand">HomeRates.ai</div>
      </div>
      <div class="sb-actions">
        <button class="btn" id="newChatBtn">New Chat</button>
        <button class="btn" id="saveChatBtn">Save</button>
      </div>

      <div class="sb-section">
        <div class="sb-title">Projects</div>
        <ul class="sb-list" id="projectsList">
          <!-- future: populated by main.js -->
          <li data-action="new-project">+ New Project</li>
        </ul>
      </div>

      <div class="sb-section">
        <div class="sb-title">History</div>
        <ul class="sb-list" id="historyList">
          <!-- future: saved threads -->
        </ul>
      </div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="title">Ask Me Anything</div>
        <div class="loading" id="loading">loading…</div>
        <button class="btn toggle" id="toggleSidebar">Menu</button>
      </div>

      <div class="thread" id="thread"></div>

      <form class="composer" id="composer">
        <textarea id="query" class="query" placeholder="Ask about mortgages, payments, programs…"></textarea>
        <button id="send" class="btn send">Send</button>
      </form>
    </main>
  </div>
  <div class="overlay" id="overlay"></div>

  <!-- Your existing JS (we cache-bust to v=22) -->
  <script src="/main.js?v=22"></script>

  <!-- Tiny helper so the sidebar toggles even if main.js is busy -->
  <script>
    (function(){
      try{
        var body=document.body, t=document.getElementById('toggleSidebar'), ov=document.getElementById('overlay');
        if(t){ t.addEventListener('click', function(){ body.classList.toggle('sidebar-open'); }); }
        if(ov){ ov.addEventListener('click', function(){ body.classList.remove('sidebar-open'); }); }
      }catch(e){ console.warn('inline toggle failed', e); }
    })();
  </script>
</body>
</html>
